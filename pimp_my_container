#!/usr/bin/env bash
# Pimp my container
# Developed by David Latorre (LatorreDev)

Install_Requirements(){
sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
sudo apt-add-repository 'deb https://apt.dockerproject.org/repo ubuntu-xenial main'
sudo apt update && sudo apt install -y docker  docker-engine git
}

Start_Docker(){
echo "Starting Docker Daemon"
sudo service docker start
echo "Docker Daemon Started"
}

Create_Volume(){
echo 'Creating docker volume'
read -r -p 'Which name do you want for your volume? (No blank spaces allowed):' Volume_Name
sudo docker volume create "$Volume_Name"
echo 'volume created'
sleep 3
}

List_Volumes(){
echo 'Listing Volumes'
sudo docker volume ls
sleep 3
}

List_Images_Installed(){
echo 'Listing Installed Docker Images'
docker image ls
sleep 3
}

Download_Container(){
echo "check on dockerhub.com which image do you want to download"
echo "Only pass username/image ie: latorredev/python3 don't pass the docker pull command"
read -r -p "Image to pull?: " IMAGE_NAME  
echo "Downloading container"
sudo docker pull "$IMAGE_NAME"
echo "Container downloaded"
}

Run_Container(){
echo "starting container"
sudo docker run -p 22:22 -d -it -v
~/docker:/ ubuntu
echo "Container running"
}

List_Containers(){
echo "active containers"
sudo docker ps
sleep 3
}

Connect_Container(){
echo "connecting to container"
sudo docker exec -it $(docker ps | tail -1 | rev | cut -d " " -f 1 | rev) /bin/bash
echo "detached from container"
}

Stop_Container(){
echo "Stopping container"
sudo docker stop $(docker ps | tail -1 | rev | cut -d " " -f 1 | rev)
echo "Container stopped"
}

while true; do
echo -e "\e[1;32m***********************************\e[0m"
echo -e "\e[1;32m* Pimp my container for Ubuntu 16 *\e[0m"
echo -e "\e[1;32m***********************************\e[0m"
	options=(
		"Install Requirements"
		"Start Docker Service"
		"Create volume"
		"List Volumes"
		"List Images Installed"
	        "Download container"
	        "Run container"
	        "List containers"
	        "Connect to the container"
	        "Stop container"
	        "Exit")
		select opt in "${options[@]}"
		do                                                                              
			case $opt in
			"Install Requirements")
			Install_Requirements
			break
			;;

			"Start Docker Service")
			Start_Docker
			break
			;;

			"Create volume")
			Create_Volume
			break
			;;

			"List Volumes")
			List_Volumes
			break
			;;

			"List Images Installed")
			List_Images_Installed
			break
			;;

			"Download container")
			Download_Container
			break
			;;

			"Run container")
			Run_Container
			break
			;;

			"List containers")
			List_Containers
			break
			;;

			"Connect to the container")
			Connect_Container
			break
			;;

			"Stop container")
			Stop_Container
			break
			;;

			"Exit")
    			break 2
    			;;

			*) echo invalid option;;
    		esac
	done
done
